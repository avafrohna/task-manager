{"ast":null,"code":"import{Link}from'react-router-dom';import{useEffect,useState}from'react';import axios from'axios';import Header from'./header';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function TaskListPage(){const[tasks,setTasks]=useState([]);const[error,setError]=useState(null);const[progress,setProgress]=useState({total:0,completed:0});const progressPercentage=progress.total>0?progress.completed/progress.total*100:0;useEffect(()=>{const fetchProgress=async()=>{try{const token=localStorage.getItem('token');if(!token){throw new Error('No token found, please login again.');}console.log('Fetching task progress...');const response=await axios.get(`${process.env.REACT_APP_API_URL}/api/tasks/progress`,{headers:{Authorization:`Bearer ${token}`}});setProgress(response.data);console.log('Task progress fetched:',response.data);}catch(err){var _err$response,_err$response$data;console.error('Error fetching task progress:',err);setError(`Error fetching task progress: ${((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||err.message}`);}};fetchProgress();},[]);useEffect(()=>{const fetchTasks=async()=>{try{const token=localStorage.getItem('token');if(!token){throw new Error('No token found, please login again.');}console.log('Fetching tasks...');const response=await axios.get(`${process.env.REACT_APP_API_URL}/api/tasks`,{headers:{Authorization:`Bearer ${token}`}});setTasks(response.data);console.log('Tasks fetched:',response.data);}catch(err){var _err$response2,_err$response2$data;console.error('Error fetching tasks:',err);setError(`Error fetching tasks: ${((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.error)||err.message}`);}};fetchTasks();},[]);const deleteProjects=async id=>{try{console.log(`Deleting task with ID: ${id}`);const token=localStorage.getItem('token');await axios.delete(`${process.env.REACT_APP_API_URL}/api/tasks/${id}`,{headers:{Authorization:`Bearer ${token}`}});setTasks(tasks.filter(task=>task.id!==id));console.log(`Task with ID ${id} deleted successfully`);}catch(err){var _err$response3,_err$response3$data;console.error('Error deleting task:',err);setError(`Error deleting task: ${((_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.error)||err.message}`);}};const cutOffText=(text,maxLength)=>{if(text.length>maxLength){return text.substring(0,maxLength)+'...';}return text;};return/*#__PURE__*/_jsxs(\"div\",{id:\"tasks\",children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"container-custom mt-3\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Tasks\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4\",children:/*#__PURE__*/_jsx(Link,{to:\"/add-task\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",children:\"Add Task\"})})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h3\",{children:\"Progress:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"progress\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"progress-bar\",role:\"progressbar\",style:{width:`${progressPercentage}%`},\"aria-valuenow\":progressPercentage,\"aria-valuemin\":\"0\",\"aria-valuemax\":\"100\",children:[Math.round(progressPercentage),\"%\"]})}),/*#__PURE__*/_jsxs(\"p\",{children:[progress.completed,\" out of \",progress.total,\" tasks completed\"]}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"text-danger\",children:error}),tasks.length>0?/*#__PURE__*/_jsx(\"table\",{className:\"table table-striped mt-4\",children:/*#__PURE__*/_jsx(\"tbody\",{children:tasks.map(task=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"fw-bold fs-4\",children:[cutOffText(task.title,30),/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-success ms-3\",children:[\"Status: \",task.status]})]}),/*#__PURE__*/_jsx(\"div\",{children:cutOffText(task.description,90)})]}),/*#__PURE__*/_jsxs(\"td\",{className:\"text-end\",children:[/*#__PURE__*/_jsx(Link,{to:`/edit-task/${task.id}`,children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary me-2\",children:\"Edit\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger me-2\",onClick:()=>deleteProjects(task.id),children:\"Delete\"})]})]},task.id))})}):/*#__PURE__*/_jsx(\"p\",{children:\"No tasks available.\"})]})]});}export default TaskListPage;","map":{"version":3,"names":["Link","useEffect","useState","axios","Header","jsx","_jsx","jsxs","_jsxs","TaskListPage","tasks","setTasks","error","setError","progress","setProgress","total","completed","progressPercentage","fetchProgress","token","localStorage","getItem","Error","console","log","response","get","process","env","REACT_APP_API_URL","headers","Authorization","data","err","_err$response","_err$response$data","message","fetchTasks","_err$response2","_err$response2$data","deleteProjects","id","delete","filter","task","_err$response3","_err$response3$data","cutOffText","text","maxLength","length","substring","children","className","to","role","style","width","Math","round","map","title","status","description","onClick"],"sources":["/Users/avafrohna/Code/cloudcomputing/task-manager/src/components/task-list.jsx"],"sourcesContent":["import { Link } from 'react-router-dom';\nimport { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Header from './header';\n\nfunction TaskListPage() {\n  const [tasks, setTasks] = useState([]);\n  const [error, setError] = useState(null);\n  const [progress, setProgress] = useState({ total: 0, completed: 0 });\n\n  const progressPercentage = progress.total > 0 ? (progress.completed / progress.total) * 100 : 0;\n\n  useEffect(() => {\n    const fetchProgress = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        if (!token) {\n          throw new Error('No token found, please login again.');\n        }\n\n        console.log('Fetching task progress...');\n        const response = await axios.get(`${process.env.REACT_APP_API_URL}/api/tasks/progress`, {\n          headers: { Authorization: `Bearer ${token}` },\n        });\n        setProgress(response.data);\n        console.log('Task progress fetched:', response.data);\n      } \n      catch (err) {\n        console.error('Error fetching task progress:', err);\n        setError(`Error fetching task progress: ${err.response?.data?.error || err.message}`);\n      }\n    };\n\n    fetchProgress();\n  }, []);\n\n  useEffect(() => {\n    const fetchTasks = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        if (!token) {\n          throw new Error('No token found, please login again.');\n        }\n\n        console.log('Fetching tasks...');\n        const response = await axios.get(`${process.env.REACT_APP_API_URL}/api/tasks`, {\n          headers: { Authorization: `Bearer ${token}` }\n        });\n        setTasks(response.data);\n        console.log('Tasks fetched:', response.data);\n      } \n      catch (err) {\n        console.error('Error fetching tasks:', err);\n        setError(`Error fetching tasks: ${err.response?.data?.error || err.message}`);\n      }\n    };\n\n    fetchTasks();\n  }, []);\n\n  const deleteProjects = async (id) => {\n    try {\n      console.log(`Deleting task with ID: ${id}`);\n      const token = localStorage.getItem('token');\n      await axios.delete(`${process.env.REACT_APP_API_URL}/api/tasks/${id}`, {\n        headers: { Authorization: `Bearer ${token}` }\n      });\n      setTasks(tasks.filter(task => task.id !== id));\n      console.log(`Task with ID ${id} deleted successfully`);\n    } \n    catch (err) {\n      console.error('Error deleting task:', err);\n      setError(`Error deleting task: ${err.response?.data?.error || err.message}`);\n    }\n  };\n\n  const cutOffText = (text, maxLength) => {\n    if (text.length > maxLength) {\n      return text.substring(0, maxLength) + '...';\n    }\n    return text;\n  };\n\n  return (\n    <div id=\"tasks\">\n      <Header />\n\n      <div className=\"container-custom mt-3\">\n        <h1>Tasks</h1>\n\n        <div className=\"mt-4\">\n          <Link to=\"/add-task\">\n            <button className=\"btn btn-primary\">Add Task</button>\n          </Link>\n        </div>\n\n        <br />\n\n        <h3>Progress:</h3>\n        <div className=\"progress\">\n          <div\n            className=\"progress-bar\"\n            role=\"progressbar\"\n            style={{ width: `${progressPercentage}%` }}\n            aria-valuenow={progressPercentage}\n            aria-valuemin=\"0\"\n            aria-valuemax=\"100\"\n          >\n            {Math.round(progressPercentage)}%\n          </div>\n        </div>\n        <p>{progress.completed} out of {progress.total} tasks completed</p>\n\n        {error && <p className=\"text-danger\">{error}</p>}\n\n        {tasks.length > 0 ? (\n          <table className=\"table table-striped mt-4\">\n            <tbody>\n              {tasks.map((task) => (\n                <tr key={task.id}>\n                  <td>\n                    <div className='fw-bold fs-4'>\n                      {cutOffText(task.title, 30)}\n                      {<button className=\"btn btn-success ms-3\">Status: {task.status}</button>}\n                    </div>\n                    <div>{cutOffText(task.description, 90)}</div>\n                  </td>\n                  <td className=\"text-end\">\n                    <Link to={`/edit-task/${task.id}`}>\n                      <button className=\"btn btn-secondary me-2\">Edit</button>\n                    </Link>\n                    <button\n                      className=\"btn btn-danger me-2\"\n                      onClick={() => deleteProjects(task.id)}\n                    >\n                      Delete\n                    </button>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        ) : (\n          <p>No tasks available.</p>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default TaskListPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}